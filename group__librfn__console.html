<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>librfn: Command console</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librfn
   </div>
   <div id="projectbrief">An ad-hoc utility library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Command console</div>  </div>
</div><!--header-->
<div class="contents">

<p>Lightweight command interpreter implemented as a protothreads.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structconsole__cmd__t.html">console_cmd_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Console command descriptor.  <a href="structconsole__cmd__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structconsole.html">console</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Console descriptor.  <a href="structconsole.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structconsole__gpio__t.html">console_gpio_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO command descriptor.  <a href="structconsole__gpio__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga7662600f7e79ccd5428509551190841a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga7662600f7e79ccd5428509551190841a">CONSOLE_CMD_VAR_INIT</a>(n,  f)                                                                                      </td></tr>
<tr class="separator:ga7662600f7e79ccd5428509551190841a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad56ab5947c69204b0602b093d3e1de40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#gad56ab5947c69204b0602b093d3e1de40">SCRATCH_SIZE</a>&#160;&#160;&#160;80</td></tr>
<tr class="separator:gad56ab5947c69204b0602b093d3e1de40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7cc0a7ae16fbd774567e56a4aa4acc02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga7cc0a7ae16fbd774567e56a4aa4acc02">CONSOLE_GPIO_VAR_INIT</a>(name,  port_,  pin_,  flags_)                                          </td></tr>
<tr class="separator:ga7cc0a7ae16fbd774567e56a4aa4acc02"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga892dc32de1ae23abfce82d8db59301d1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structconsole.html">console</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a></td></tr>
<tr class="memdesc:ga892dc32de1ae23abfce82d8db59301d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Console descriptor.  <a href="#ga892dc32de1ae23abfce82d8db59301d1">More...</a><br /></td></tr>
<tr class="separator:ga892dc32de1ae23abfce82d8db59301d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaa1edac09dc90476b328e5bb1e409770e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#gaa1edac09dc90476b328e5bb1e409770e">console_gpio_flags_t</a> { <a class="el" href="group__librfn__console.html#ggaa1edac09dc90476b328e5bb1e409770ea382cc0efa79c47450a3a0b9b2d49328c">console_gpio_active_low</a> = 0x01, 
<a class="el" href="group__librfn__console.html#ggaa1edac09dc90476b328e5bb1e409770eacfd1f997fe6cb5f9519c881b8b0b1057">console_gpio_default_on</a> = 0x02, 
<a class="el" href="group__librfn__console.html#ggaa1edac09dc90476b328e5bb1e409770ea847bb0b5994c3ea5bfaeb5d88b25c7a4">console_gpio_open_drain</a> = 0x04, 
<a class="el" href="group__librfn__console.html#ggaa1edac09dc90476b328e5bb1e409770ea98ef11f2917ff1a9f2ea3432239b0868">console_gpio_explore</a> = 0x08
 }<tr class="memdesc:gaa1edac09dc90476b328e5bb1e409770e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request special features from the GPIO command.  <a href="group__librfn__console.html#gaa1edac09dc90476b328e5bb1e409770e">More...</a><br /></td></tr>
<tr class="separator:gaa1edac09dc90476b328e5bb1e409770e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2811e7735cdadca2509a70a6c9e0083c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga2811e7735cdadca2509a70a6c9e0083c">console_init</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>, FILE *f)</td></tr>
<tr class="memdesc:ga2811e7735cdadca2509a70a6c9e0083c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialized the console handler.  <a href="#ga2811e7735cdadca2509a70a6c9e0083c">More...</a><br /></td></tr>
<tr class="separator:ga2811e7735cdadca2509a70a6c9e0083c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab51bdf572eb1aa273607fd7790e42cba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#gab51bdf572eb1aa273607fd7790e42cba">console_hwinit</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>)</td></tr>
<tr class="memdesc:gab51bdf572eb1aa273607fd7790e42cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Platform dependant function that will be called during <a class="el" href="group__librfn__console.html#ga2811e7735cdadca2509a70a6c9e0083c" title="Initialized the console handler. ">console_init()</a>.  <a href="#gab51bdf572eb1aa273607fd7790e42cba">More...</a><br /></td></tr>
<tr class="separator:gab51bdf572eb1aa273607fd7790e42cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20170562194655b267ae1a6f91bf0749"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga20170562194655b267ae1a6f91bf0749">console_register</a> (const <a class="el" href="structconsole__cmd__t.html">console_cmd_t</a> *cmd)</td></tr>
<tr class="memdesc:ga20170562194655b267ae1a6f91bf0749"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a new command.  <a href="#ga20170562194655b267ae1a6f91bf0749">More...</a><br /></td></tr>
<tr class="separator:ga20170562194655b267ae1a6f91bf0749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd59d15d518436a8239a81f34d0299f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#gacd59d15d518436a8239a81f34d0299f8">console_putchar</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>, char d)</td></tr>
<tr class="memdesc:gacd59d15d518436a8239a81f34d0299f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Asynchronously send a character to the command processor.  <a href="#gacd59d15d518436a8239a81f34d0299f8">More...</a><br /></td></tr>
<tr class="separator:gacd59d15d518436a8239a81f34d0299f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga775107692a3f167764bf0c3290827443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__librfn__protothreads.html#ga80f6549205df67edda2c6d263d608165">pt_state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga775107692a3f167764bf0c3290827443">console_eval</a> (<a class="el" href="group__librfn__protothreads.html#ga0d1ef30dbc000ae70163a3fe20da916c">pt_t</a> *pt, <a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>, const char *cmd)</td></tr>
<tr class="memdesc:ga775107692a3f167764bf0c3290827443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proto-thread to inject a string into the command parser.  <a href="#ga775107692a3f167764bf0c3290827443">More...</a><br /></td></tr>
<tr class="separator:ga775107692a3f167764bf0c3290827443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20a42964fe45f820793ced3ae10dc957"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga20a42964fe45f820793ced3ae10dc957">console_getch</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>)</td></tr>
<tr class="memdesc:ga20a42964fe45f820793ced3ae10dc957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch a character from the command processors queue.  <a href="#ga20a42964fe45f820793ced3ae10dc957">More...</a><br /></td></tr>
<tr class="separator:ga20a42964fe45f820793ced3ae10dc957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b9e01c3f6329d63a57b06434ea4cb06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__librfn__protothreads.html#ga80f6549205df67edda2c6d263d608165">pt_state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga6b9e01c3f6329d63a57b06434ea4cb06">console_run</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>)</td></tr>
<tr class="memdesc:ga6b9e01c3f6329d63a57b06434ea4cb06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Console protothread entrypoint.  <a href="#ga6b9e01c3f6329d63a57b06434ea4cb06">More...</a><br /></td></tr>
<tr class="separator:ga6b9e01c3f6329d63a57b06434ea4cb06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a2a7cd4f2a82bf7cc9e67cced3037f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#ga8a2a7cd4f2a82bf7cc9e67cced3037f2">console_process</a> (<a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *<a class="el" href="utiltest_8c.html#abb99fb554263c3a2c7d10ed808abc12a">c</a>, char d)</td></tr>
<tr class="memdesc:ga8a2a7cd4f2a82bf7cc9e67cced3037f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronous console function for use in threaded environments.  <a href="#ga8a2a7cd4f2a82bf7cc9e67cced3037f2">More...</a><br /></td></tr>
<tr class="separator:ga8a2a7cd4f2a82bf7cc9e67cced3037f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf791990c5a1e5475dec85acd3cfc81fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__console.html#gaf791990c5a1e5475dec85acd3cfc81fc">console_gpio_register</a> (const <a class="el" href="structconsole__gpio__t.html">console_gpio_t</a> *gpio)</td></tr>
<tr class="memdesc:gaf791990c5a1e5475dec85acd3cfc81fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a new GPIO command.  <a href="#gaf791990c5a1e5475dec85acd3cfc81fc">More...</a><br /></td></tr>
<tr class="separator:gaf791990c5a1e5475dec85acd3cfc81fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Lightweight command interpreter implemented as a protothreads. </p>
<p>The use of protothreads means this command interpreter can be used effectively on run-to-completion schedulers and comes with out of the box support for fibres.</p>
<dl class="section note"><dt>Note</dt><dd>The use of the fibre scheduler is optional (although the fibre header file is needed to compile source without modification).</dd></dl>
<p>No dynamic memory allocation is required by the console handling (although currently it uses stdio. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga7662600f7e79ccd5428509551190841a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONSOLE_CMD_VAR_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{                                                                      \</div>
<div class="line">                .name = (n),                                                   \</div>
<div class="line">                .fn = (f)                                                      \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="console_8h_source.html#l00052">52</a> of file <a class="el" href="console_8h_source.html">console.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga7cc0a7ae16fbd774567e56a4aa4acc02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONSOLE_GPIO_VAR_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">port_, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pin_, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">flags_&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{                                                                      \</div>
<div class="line">                .cmd = <a class="code" href="group__librfn__console.html#ga7662600f7e79ccd5428509551190841a">CONSOLE_CMD_VAR_INIT</a>(name, <a class="code" href="group__librfn__console.html#gabb251c37d35eded4c973a9da31fea8ac">console_gpio_do_cmd</a>),        \</div>
<div class="line">                .port = port_, .pin = pin_, .flags = flags_                    \</div>
<div class="line">        }</div>
<div class="ttc" id="group__librfn__console_html_ga7662600f7e79ccd5428509551190841a"><div class="ttname"><a href="group__librfn__console.html#ga7662600f7e79ccd5428509551190841a">CONSOLE_CMD_VAR_INIT</a></div><div class="ttdeci">#define CONSOLE_CMD_VAR_INIT(n, f)                                                                                      </div><div class="ttdef"><b>Definition:</b> <a href="console_8h_source.html#l00052">console.h:52</a></div></div>
<div class="ttc" id="group__librfn__console_html_gabb251c37d35eded4c973a9da31fea8ac"><div class="ttname"><a href="group__librfn__console.html#gabb251c37d35eded4c973a9da31fea8ac">console_gpio_do_cmd</a></div><div class="ttdeci">pt_state_t console_gpio_do_cmd(console_t *c)</div><div class="ttdef"><b>Definition:</b> <a href="console__cmd__gpio_8c_source.html#l00151">console_cmd_gpio.c:151</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="console_8h_source.html#l00263">263</a> of file <a class="el" href="console_8h_source.html">console.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad56ab5947c69204b0602b093d3e1de40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCRATCH_SIZE&#160;&#160;&#160;80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="console_8h_source.html#l00058">58</a> of file <a class="el" href="console_8h_source.html">console.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga892dc32de1ae23abfce82d8db59301d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structconsole.html">console</a>  <a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Console descriptor. </p>
<p>This is a relatively large structure (164 bytes on a 32-bit machine) due to the integrated scratch array. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="gaa1edac09dc90476b328e5bb1e409770e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__librfn__console.html#gaa1edac09dc90476b328e5bb1e409770e">console_gpio_flags_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request special features from the GPIO command. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ggaa1edac09dc90476b328e5bb1e409770ea382cc0efa79c47450a3a0b9b2d49328c"></a>console_gpio_active_low&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaa1edac09dc90476b328e5bb1e409770eacfd1f997fe6cb5f9519c881b8b0b1057"></a>console_gpio_default_on&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaa1edac09dc90476b328e5bb1e409770ea847bb0b5994c3ea5bfaeb5d88b25c7a4"></a>console_gpio_open_drain&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaa1edac09dc90476b328e5bb1e409770ea98ef11f2917ff1a9f2ea3432239b0868"></a>console_gpio_explore&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="console_8h_source.html#l00238">238</a> of file <a class="el" href="console_8h_source.html">console.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga775107692a3f167764bf0c3290827443"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__librfn__protothreads.html#ga80f6549205df67edda2c6d263d608165">pt_state_t</a> console_eval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__protothreads.html#ga0d1ef30dbc000ae70163a3fe20da916c">pt_t</a> *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Proto-thread to inject a string into the command parser. </p>
<p>When buffering is already happening somewhere else in the system then this is a safe alternative to <a class="el" href="group__librfn__console.html#gacd59d15d518436a8239a81f34d0299f8" title="Asynchronously send a character to the command processor. ">console_putchar()</a> since it will yield rather than dropping input during overflow conditions. </p>

<p>Definition at line <a class="el" href="console_8c_source.html#l00189">189</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga20a42964fe45f820793ced3ae10dc957"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int console_getch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetch a character from the command processors queue. </p>
<p>This function is used internally by the command processor and may also be used by console commands to read character input from the user. It must not be called outside of console command handling (because it will race with the command processor to handle the character).</p>
<p>It is safe to use <a class="el" href="group__librfn__protothreads.html#ga85de79ef3e7e92331e8b2aee28dbc234">PT_WAIT_UNTIL()</a> to wait until a character is received because the console fibre, which is used to execute console commands, will be woken up for each new character received.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// ch need not be static unless the it is used after another wait.</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int ch;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;PT_WAIT_UNTIL((ch = console_getchar(c)) != -1);</div>
</div><!-- fragment --> 
<p>Definition at line <a class="el" href="console_8c_source.html#l00172">172</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf791990c5a1e5475dec85acd3cfc81fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int console_gpio_register </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structconsole__gpio__t.html">console_gpio_t</a> *&#160;</td>
          <td class="paramname"><em>gpio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a new GPIO command. </p>

<p>Definition at line <a class="el" href="console__cmd__gpio_8c_source.html#l00211">211</a> of file <a class="el" href="console__cmd__gpio_8c_source.html">console_cmd_gpio.c</a>.</p>

</div>
</div>
<a class="anchor" id="gab51bdf572eb1aa273607fd7790e42cba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void console_hwinit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Platform dependant function that will be called during <a class="el" href="group__librfn__console.html#ga2811e7735cdadca2509a70a6c9e0083c" title="Initialized the console handler. ">console_init()</a>. </p>
<p>librfn provides example implementations of this function but, in some cases, this function must be provided by the application. </p>

<p>Definition at line <a class="el" href="console__cdcacm_8c_source.html#l00369">369</a> of file <a class="el" href="console__cdcacm_8c_source.html">console_cdcacm.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2811e7735cdadca2509a70a6c9e0083c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void console_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialized the console handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Pointer to console descriptor </td></tr>
    <tr><td class="paramname">f</td><td>File pointer to be used for all console output </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="console_8c_source.html#l00136">136</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga8a2a7cd4f2a82bf7cc9e67cced3037f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void console_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchronous console function for use in threaded environments. </p>
<p>This function can also be used to implement a command console that executes from an interrupt handler. Such a command interpreter would be extremely robust although potentially at the cost of poor interrupt latencies.</p>
<p>To use this function <a class="el" href="group__librfn__console.html#gab51bdf572eb1aa273607fd7790e42cba" title="Platform dependant function that will be called during console_init(). ">console_hwinit()</a> may have to altered to remove code that asynchronously delivers characters.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;while ((ch = getchar()) != -1)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    console_process(console, ch);</div>
</div><!-- fragment --> 
<p>Definition at line <a class="el" href="console_8c_source.html#l00254">254</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="gacd59d15d518436a8239a81f34d0299f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void console_putchar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Asynchronously send a character to the command processor. </p>
<p>This function is safe to call from interrupt. It will insert a character into the command processors ring buffer and will, optionally, schedule the console fibre. </p>

<p>Definition at line <a class="el" href="console_8c_source.html#l00177">177</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga20170562194655b267ae1a6f91bf0749"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int console_register </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structconsole__cmd__t.html">console_cmd_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a new command. </p>
<p>The following example shows a simple protothreaded command to list the command's arguments:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;static pt_state_t listargs(console_t *c)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    static int i;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    PT_BEGIN(&amp;c-&gt;pt);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    for (i=0; i&lt;c-&gt;argc; i++) {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        fprintf(c-&gt;out, &quot;%d: %s\n&quot;, i, c-&gt;argv[i]);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        PT_YIELD();</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    }</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    PT_END();</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;static const console_cmd_t cmd_listagrs =</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    CONSOLE_CMD_VAR_INIT(&quot;listargs&quot;, listargs);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;(void) console_register(cmd_listargs);</div>
</div><!-- fragment --><p>The use of protothreading is optional. The following command is functionally equivalent although may cause a run-to-completion scheduler to run poorly if fprintf() is slow (for example if it synchronously sends characters to a serial port):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;pt_state_t listargs(console_t *c)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    for (int i=0; i&lt;c-&gt;argc; i++)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        fprintf(c-&gt;out, &quot;%d: %s\n&quot;, i, c-&gt;argv[i]);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    return PT_EXITED;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;}</div>
</div><!-- fragment --> 
<p>Definition at line <a class="el" href="console_8c_source.html#l00151">151</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga6b9e01c3f6329d63a57b06434ea4cb06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__librfn__protothreads.html#ga80f6549205df67edda2c6d263d608165">pt_state_t</a> console_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__console.html#ga892dc32de1ae23abfce82d8db59301d1">console_t</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Console protothread entrypoint. </p>
<p>This function can be used to integrate the command processor into simple polling loops or to "alien" run-to-completion schedulers.</p>
<p>The return code can be used to realize power saving modes. However a simple polling loop without support for power saving can simply ignore it.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;while (true) {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    poll_something();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    (void) console_run(console); // poll console</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    poll_something_else();</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div>
</div><!-- fragment --> 
<p>Definition at line <a class="el" href="console_8c_source.html#l00217">217</a> of file <a class="el" href="console_8c_source.html">console.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 6 2016 21:25:32 for librfn by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
