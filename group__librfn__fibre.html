<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>librfn: Fibre</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">librfn
   </div>
   <div id="projectbrief">An ad-hoc utility library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Fibre</div>  </div>
</div><!--header-->
<div class="contents">

<p>Lightweight run-to-completion task scheduler supporting protothreads.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfibre.html">fibre</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fibre descriptor.  <a href="structfibre.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfibre__eventq.html">fibre_eventq</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fibre and eventq descriptor.  <a href="structfibre__eventq.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab318537d35f3ee1e7daadc5fed213a96"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#gab318537d35f3ee1e7daadc5fed213a96">FIBRE_UNBOUNDED_SLEEP</a>&#160;&#160;&#160;((uint32_t) 0x7fffffff)</td></tr>
<tr class="memdesc:gab318537d35f3ee1e7daadc5fed213a96"><td class="mdescLeft">&#160;</td><td class="mdescRight">An approximation of infinitely far in the future.  <a href="#gab318537d35f3ee1e7daadc5fed213a96">More...</a><br /></td></tr>
<tr class="separator:gab318537d35f3ee1e7daadc5fed213a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga014dcbd09e287ff7542b54ca11fbc727"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga014dcbd09e287ff7542b54ca11fbc727">FIBRE_VAR_INIT</a>(fn)&#160;&#160;&#160;{ (fn), 0, 0, 0, <a class="el" href="group__librfn__list.html#gade4dccecec4f0c2b9cc2c675db7a4b0d">LIST_NODE_VAR_INIT</a> }</td></tr>
<tr class="memdesc:ga014dcbd09e287ff7542b54ca11fbc727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static initializer for a fibre descriptor.  <a href="#ga014dcbd09e287ff7542b54ca11fbc727">More...</a><br /></td></tr>
<tr class="separator:ga014dcbd09e287ff7542b54ca11fbc727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e0494fc880dd59a03422e0db1188d1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga3e0494fc880dd59a03422e0db1188d1d">FIBRE_EVENTQ_VAR_INIT</a>(fn,  basep,  base_len,  msg_len)</td></tr>
<tr class="memdesc:ga3e0494fc880dd59a03422e0db1188d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static initializer for a fibre and eventq descriptor.  <a href="#ga3e0494fc880dd59a03422e0db1188d1d">More...</a><br /></td></tr>
<tr class="separator:ga3e0494fc880dd59a03422e0db1188d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8876b45b469b40716a5f5f593cb0cbfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga8876b45b469b40716a5f5f593cb0cbfa">PT_BEGIN_FIBRE</a>(f)&#160;&#160;&#160;<a class="el" href="group__librfn__protothreads.html#gac3955a428fe95f5e1206bda38376e6c0">PT_BEGIN</a>(&amp;((f)-&gt;priv))</td></tr>
<tr class="memdesc:ga8876b45b469b40716a5f5f593cb0cbfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fibre aware alternative to <a class="el" href="group__librfn__protothreads.html#gac3955a428fe95f5e1206bda38376e6c0">PT_BEGIN()</a>.  <a href="#ga8876b45b469b40716a5f5f593cb0cbfa">More...</a><br /></td></tr>
<tr class="separator:ga8876b45b469b40716a5f5f593cb0cbfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga60461276044627390cd619ebcd268a3c"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga60461276044627390cd619ebcd268a3c">fibre_entrypoint_t</a>(struct <a class="el" href="structfibre.html">fibre</a> *)</td></tr>
<tr class="separator:ga60461276044627390cd619ebcd268a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga331f889be721bc7d03a89e1c71f9bd48"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structfibre.html">fibre</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a></td></tr>
<tr class="memdesc:ga331f889be721bc7d03a89e1c71f9bd48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fibre descriptor.  <a href="#ga331f889be721bc7d03a89e1c71f9bd48">More...</a><br /></td></tr>
<tr class="separator:ga331f889be721bc7d03a89e1c71f9bd48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81d6ee0a85fc550cdbacafc4147cb146"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structfibre__eventq.html">fibre_eventq</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a></td></tr>
<tr class="memdesc:ga81d6ee0a85fc550cdbacafc4147cb146"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fibre and eventq descriptor.  <a href="#ga81d6ee0a85fc550cdbacafc4147cb146">More...</a><br /></td></tr>
<tr class="separator:ga81d6ee0a85fc550cdbacafc4147cb146"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga9c65608b6e0305229fffaf45580c5df7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga9c65608b6e0305229fffaf45580c5df7">fibre_state_t</a> { <br />
&#160;&#160;<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7a7d539cf3e548904fe24f340f341a87b0">FIBRE_STATE_YIELDED</a> = PT_YIELDED, 
<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7ae968a767bb5f4b9a50d7e0994791d3c1">FIBRE_STATE_WAITING</a> = PT_WAITING, 
<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7ad411090ab21f251d888fd7979ae1784d">FIBRE_STATE_EXITED</a> = PT_EXITED, 
<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7a83266ee9c52fb7faa2417428ae808888">FIBRE_STATE_RUNNING</a>, 
<br />
&#160;&#160;<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7a0fc3ba0f9032f704107af2c6d7978ac1">FIBRE_STATE_QUEUED</a> = 0x10, 
<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7ae8af09a15940f5927acca13ba3e288af">FIBRE_STATE_TIMER_WAITING</a> = FIBRE_STATE_WAITING | FIBRE_STATE_QUEUED, 
<a class="el" href="group__librfn__fibre.html#gga9c65608b6e0305229fffaf45580c5df7aa37f0ef1d55552f90c3b4447fd59075d">FIBRE_STATE_RUNNABLE</a> = FIBRE_STATE_RUNNING | FIBRE_STATE_QUEUED
<br />
 }<tr class="separator:ga9c65608b6e0305229fffaf45580c5df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga649521d68a4479dcaadefc00c04e07de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga649521d68a4479dcaadefc00c04e07de">fibre_self</a> (void)</td></tr>
<tr class="memdesc:ga649521d68a4479dcaadefc00c04e07de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the currently active fibre descriptor.  <a href="#ga649521d68a4479dcaadefc00c04e07de">More...</a><br /></td></tr>
<tr class="separator:ga649521d68a4479dcaadefc00c04e07de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d1c81c0a94aedc4263d2ecf39d015c6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga1d1c81c0a94aedc4263d2ecf39d015c6">fibre_scheduler_next</a> (uint32_t time)</td></tr>
<tr class="memdesc:ga1d1c81c0a94aedc4263d2ecf39d015c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule the next fibre.  <a href="#ga1d1c81c0a94aedc4263d2ecf39d015c6">More...</a><br /></td></tr>
<tr class="separator:ga1d1c81c0a94aedc4263d2ecf39d015c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbba9af260b3f64de2a2f4f3c5e5915f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#gadbba9af260b3f64de2a2f4f3c5e5915f">fibre_init</a> (<a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *f, <a class="el" href="group__librfn__fibre.html#ga60461276044627390cd619ebcd268a3c">fibre_entrypoint_t</a> *fn)</td></tr>
<tr class="memdesc:gadbba9af260b3f64de2a2f4f3c5e5915f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic initializer for a fibre descriptor.  <a href="#gadbba9af260b3f64de2a2f4f3c5e5915f">More...</a><br /></td></tr>
<tr class="separator:gadbba9af260b3f64de2a2f4f3c5e5915f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga384abf562208ac5429e3b235087e050c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga384abf562208ac5429e3b235087e050c">fibre_run</a> (<a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *f)</td></tr>
<tr class="separator:ga384abf562208ac5429e3b235087e050c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1941af326532e674aa7351efa1149584"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga1941af326532e674aa7351efa1149584">fibre_run_atomic</a> (<a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *f)</td></tr>
<tr class="separator:ga1941af326532e674aa7351efa1149584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f1040bc243f058e4d4c371154984ff0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga9f1040bc243f058e4d4c371154984ff0">fibre_kill</a> (<a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *f)</td></tr>
<tr class="separator:ga9f1040bc243f058e4d4c371154984ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ea8c39f5c7b861bed8a4a9333b92c7f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga3ea8c39f5c7b861bed8a4a9333b92c7f">fibre_timeout</a> (uint32_t duetime)</td></tr>
<tr class="separator:ga3ea8c39f5c7b861bed8a4a9333b92c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad67dca9ba63a195259594faba572219c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#gad67dca9ba63a195259594faba572219c">fibre_eventq_init</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq, <a class="el" href="group__librfn__fibre.html#ga60461276044627390cd619ebcd268a3c">fibre_entrypoint_t</a> *fn, void *basep, size_t base_len, size_t msg_len)</td></tr>
<tr class="memdesc:gad67dca9ba63a195259594faba572219c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic initializer for a fibre and eventq descriptor.  <a href="#gad67dca9ba63a195259594faba572219c">More...</a><br /></td></tr>
<tr class="separator:gad67dca9ba63a195259594faba572219c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6842ca873787f551a21cee20ed94da3c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga6842ca873787f551a21cee20ed94da3c">fibre_eventq_claim</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq)</td></tr>
<tr class="memdesc:ga6842ca873787f551a21cee20ed94da3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request memory resources to send an event to a fibre.  <a href="#ga6842ca873787f551a21cee20ed94da3c">More...</a><br /></td></tr>
<tr class="separator:ga6842ca873787f551a21cee20ed94da3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga303d775e6445b3a69061c8c728a0b52f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga303d775e6445b3a69061c8c728a0b52f">fibre_eventq_send</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq, void *evtp)</td></tr>
<tr class="memdesc:ga303d775e6445b3a69061c8c728a0b52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an event to a fibre.  <a href="#ga303d775e6445b3a69061c8c728a0b52f">More...</a><br /></td></tr>
<tr class="separator:ga303d775e6445b3a69061c8c728a0b52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7dd42eb2e3542c0b7f2be42829aaac78"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga7dd42eb2e3542c0b7f2be42829aaac78">fibre_eventq_empty</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq)</td></tr>
<tr class="memdesc:ga7dd42eb2e3542c0b7f2be42829aaac78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if the fibre's event queue is empty.  <a href="#ga7dd42eb2e3542c0b7f2be42829aaac78">More...</a><br /></td></tr>
<tr class="separator:ga7dd42eb2e3542c0b7f2be42829aaac78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a4d7c725ea9e76b60e35fd8c7fae7a9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga8a4d7c725ea9e76b60e35fd8c7fae7a9">fibre_eventq_receive</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq)</td></tr>
<tr class="memdesc:ga8a4d7c725ea9e76b60e35fd8c7fae7a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recevied a message previously send to the fibre.  <a href="#ga8a4d7c725ea9e76b60e35fd8c7fae7a9">More...</a><br /></td></tr>
<tr class="separator:ga8a4d7c725ea9e76b60e35fd8c7fae7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76e1a99d6c845f1d3c998b462291a67c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#ga76e1a99d6c845f1d3c998b462291a67c">fibre_eventq_release</a> (<a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *evtq, void *evtp)</td></tr>
<tr class="memdesc:ga76e1a99d6c845f1d3c998b462291a67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release a message previously received by a fibre.  <a href="#ga76e1a99d6c845f1d3c998b462291a67c">More...</a><br /></td></tr>
<tr class="separator:ga76e1a99d6c845f1d3c998b462291a67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac52b96caa6159a7a7bb235cd381bd456"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librfn__fibre.html#gac52b96caa6159a7a7bb235cd381bd456">fibre_scheduler_main_loop</a> (void)</td></tr>
<tr class="separator:gac52b96caa6159a7a7bb235cd381bd456"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Lightweight run-to-completion task scheduler supporting protothreads. </p>
<p>The fibre scheduler is an extremely lightweight run-to-completion task scheduler supporting protothreads. In addition to timer and run queue management it also provides support for per-fibre event queues. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga3e0494fc880dd59a03422e0db1188d1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIBRE_EVENTQ_VAR_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">basep, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">base_len, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg_len&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">                .fibre = <a class="code" href="group__librfn__fibre.html#ga014dcbd09e287ff7542b54ca11fbc727">FIBRE_VAR_INIT</a>(fn), \</div>
<div class="line">                .eventq = <a class="code" href="group__librfn__messageq.html#gac74783b6cff1c6e221cd0b16a2fd3edb">MESSAGEQ_VAR_INIT</a>(basep, base_len, msg_len) \</div>
<div class="line">        }</div>
<div class="ttc" id="group__librfn__fibre_html_ga014dcbd09e287ff7542b54ca11fbc727"><div class="ttname"><a href="group__librfn__fibre.html#ga014dcbd09e287ff7542b54ca11fbc727">FIBRE_VAR_INIT</a></div><div class="ttdeci">#define FIBRE_VAR_INIT(fn)</div><div class="ttdoc">Static initializer for a fibre descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="fibre_8h_source.html#l00075">fibre.h:75</a></div></div>
<div class="ttc" id="group__librfn__messageq_html_gac74783b6cff1c6e221cd0b16a2fd3edb"><div class="ttname"><a href="group__librfn__messageq.html#gac74783b6cff1c6e221cd0b16a2fd3edb">MESSAGEQ_VAR_INIT</a></div><div class="ttdeci">#define MESSAGEQ_VAR_INIT(basep, base_len, msg_len)</div><div class="ttdef"><b>Definition:</b> <a href="messageq_8h_source.html#l00054">messageq.h:54</a></div></div>
</div><!-- fragment -->
<p>Static initializer for a fibre and eventq descriptor. </p>

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00094">94</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<a class="anchor" id="gab318537d35f3ee1e7daadc5fed213a96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIBRE_UNBOUNDED_SLEEP&#160;&#160;&#160;((uint32_t) 0x7fffffff)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An approximation of infinitely far in the future. </p>
<p>This is the largest possible value that can be added to the current time and still yeild a value in the future (a larger value will cause the time to wrap around to be in the past).</p>
<p>With the typical 1MHz clock provided by <a class="el" href="group__librfn__time.html#ga34282d8427317436758e5e4f476f6f5d">time_now()</a>, it actually represents a little over three and a half minutes. </p>

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00056">56</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga014dcbd09e287ff7542b54ca11fbc727"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIBRE_VAR_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn</td><td>)</td>
          <td>&#160;&#160;&#160;{ (fn), 0, 0, 0, <a class="el" href="group__librfn__list.html#gade4dccecec4f0c2b9cc2c675db7a4b0d">LIST_NODE_VAR_INIT</a> }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Static initializer for a fibre descriptor. </p>

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00075">75</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga8876b45b469b40716a5f5f593cb0cbfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PT_BEGIN_FIBRE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="group__librfn__protothreads.html#gac3955a428fe95f5e1206bda38376e6c0">PT_BEGIN</a>(&amp;((f)-&gt;priv))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fibre aware alternative to <a class="el" href="group__librfn__protothreads.html#gac3955a428fe95f5e1206bda38376e6c0">PT_BEGIN()</a>. </p>

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00103">103</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga60461276044627390cd619ebcd268a3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int fibre_entrypoint_t(struct <a class="el" href="structfibre.html">fibre</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00059">59</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga81d6ee0a85fc550cdbacafc4147cb146"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structfibre__eventq.html">fibre_eventq</a>  <a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fibre and eventq descriptor. </p>
<p>This descriptor is a fibre and messag queue bound together so that events can be passed to the fibre.</p>
<p>Allows the fibre to be automatically scheduled if events are passed using <a class="el" href="group__librfn__fibre.html#ga303d775e6445b3a69061c8c728a0b52f" title="Send an event to a fibre. ">fibre_eventq_send()</a>. </p>

</div>
</div>
<a class="anchor" id="ga331f889be721bc7d03a89e1c71f9bd48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structfibre.html">fibre</a>  <a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fibre descriptor. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga9c65608b6e0305229fffaf45580c5df7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__librfn__fibre.html#ga9c65608b6e0305229fffaf45580c5df7">fibre_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7a7d539cf3e548904fe24f340f341a87b0"></a>FIBRE_STATE_YIELDED&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7ae968a767bb5f4b9a50d7e0994791d3c1"></a>FIBRE_STATE_WAITING&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7ad411090ab21f251d888fd7979ae1784d"></a>FIBRE_STATE_EXITED&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7a83266ee9c52fb7faa2417428ae808888"></a>FIBRE_STATE_RUNNING&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7a0fc3ba0f9032f704107af2c6d7978ac1"></a>FIBRE_STATE_QUEUED&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7ae8af09a15940f5927acca13ba3e288af"></a>FIBRE_STATE_TIMER_WAITING&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga9c65608b6e0305229fffaf45580c5df7aa37f0ef1d55552f90c3b4447fd59075d"></a>FIBRE_STATE_RUNNABLE&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="fibre_8h_source.html#l00034">34</a> of file <a class="el" href="fibre_8h_source.html">fibre.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga6842ca873787f551a21cee20ed94da3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* fibre_eventq_claim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request memory resources to send an event to a fibre. </p>
<dl class="section note"><dt>Note</dt><dd>If the fibre's event queue is full the kernel will automtically be tainted (the 'E' bit will be set). </dd></dl>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00226">226</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7dd42eb2e3542c0b7f2be42829aaac78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fibre_eventq_empty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return true if the fibre's event queue is empty. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00240">240</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad67dca9ba63a195259594faba572219c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fibre_eventq_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga60461276044627390cd619ebcd268a3c">fibre_entrypoint_t</a> *&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>basep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>base_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>msg_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dynamic initializer for a fibre and eventq descriptor. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00219">219</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga8a4d7c725ea9e76b60e35fd8c7fae7a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* fibre_eventq_receive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recevied a message previously send to the fibre. </p>
<p>This function can be used by a fibre to receive an event.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function should only be called by the fibre bound to the event queue and must not be called by an interrupt service routine. </dd></dl>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00245">245</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga76e1a99d6c845f1d3c998b462291a67c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fibre_eventq_release </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>evtp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release a message previously received by a fibre. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00250">250</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga303d775e6445b3a69061c8c728a0b52f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fibre_eventq_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga81d6ee0a85fc550cdbacafc4147cb146">fibre_eventq_t</a> *&#160;</td>
          <td class="paramname"><em>evtq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>evtp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an event to a fibre. </p>
<p>If the fibre is not already runnable then it will be added to the run queue. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00234">234</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="gadbba9af260b3f64de2a2f4f3c5e5915f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fibre_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga60461276044627390cd619ebcd268a3c">fibre_entrypoint_t</a> *&#160;</td>
          <td class="paramname"><em>fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dynamic initializer for a fibre descriptor. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00164">164</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9f1040bc243f058e4d4c371154984ff0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fibre_kill </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a fibre from the run queue. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00196">196</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga384abf562208ac5429e3b235087e050c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fibre_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make a fibre runnable.</p>
<p>When a fibre is made runnable it will be appended to the run queue and will, eventually be executed during a call to <a class="el" href="group__librfn__fibre.html#ga1d1c81c0a94aedc4263d2ecf39d015c6" title="Schedule the next fibre. ">fibre_scheduler_next()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Do not call this function from an interrupt service routine, use <a class="el" href="group__librfn__fibre.html#ga1941af326532e674aa7351efa1149584">fibre_run_atomic()</a> instead. </dd></dl>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00173">173</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1941af326532e674aa7351efa1149584"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fibre_run_atomic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make a fibre runnable using only atomic operations.</p>
<p>This function behaves similarly <a class="el" href="group__librfn__fibre.html#ga384abf562208ac5429e3b235087e050c">fibre_run()</a>. It is less efficient than the alternative but can be used from any calling context, including from an interrupt service routine. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00183">183</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac52b96caa6159a7a7bb235cd381bd456"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fibre_scheduler_main_loop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enter the scheduler main loop.</p>
<p>This function will dispatch threads when they become runnable and may attempt to conserve power by going idle in some implementation defined manner.</p>
<p>An implementation of this function must be provided for each execution environment. librfn only comes with an implementation for a small subset of environments and may have to be provided by the library user. POSIX environments are, however, already supported to allow the demonstation programs to work. </p>

<p>Definition at line <a class="el" href="fibre__default_8c_source.html#l00017">17</a> of file <a class="el" href="fibre__default_8c_source.html">fibre_default.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1d1c81c0a94aedc4263d2ecf39d015c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t fibre_scheduler_next </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedule the next fibre. </p>
<p>This is the heart of the fibre system. Any fibre whose due time is before time will be made runnable and the fibre at the head of the run queue will execute. When that fibre completes the scheduler returns the time of the next wakeup (which may be in the past if the run queue contains active tasks).</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="group__librfn__fibre.html#ga649521d68a4479dcaadefc00c04e07de" title="Returns the currently active fibre descriptor. ">fibre_self()</a>, when called after <a class="el" href="group__librfn__fibre.html#ga1d1c81c0a94aedc4263d2ecf39d015c6" title="Schedule the next fibre. ">fibre_scheduler_next()</a> has executed, returns the fibre that was most recently scheduled. This can be used to implement task accounting and to debug scheduling delays.</dd></dl>
<p>The return value provides the time at which the next task must be scheduled this allows low power modes to implemented by programming a wakeup timer and sleeping until it fires.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is possible for an interrupt service routine to make a fibre runnable between this function returning and entering a low power state. On ARM architecture the WFE instruction avoids potential races by managing an event flag which is set by reception of interrupt. On hardware without this feature additional work is required to safely enter low power states.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>current time in cyclic 32-bit time (e.g. 0 is one tick after 0xffffffff) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time at which the next task must be scheduled </dd></dl>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00134">134</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga649521d68a4479dcaadefc00c04e07de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__librfn__fibre.html#ga331f889be721bc7d03a89e1c71f9bd48">fibre_t</a>* fibre_self </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the currently active fibre descriptor. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00129">129</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3ea8c39f5c7b861bed8a4a9333b92c7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fibre_timeout </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>duetime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sleep until a timeout is reached.</p>
<p>Combining this function with <a class="el" href="group__librfn__protothreads.html#ga85de79ef3e7e92331e8b2aee28dbc234">PT_WAIT_UNTIL()</a> allows a fibre to sleep. It will be automatically added to the run queue when the specified time is reached. </p>

<p>Definition at line <a class="el" href="fibre_8c_source.html#l00208">208</a> of file <a class="el" href="fibre_8c_source.html">fibre.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 6 2016 21:25:32 for librfn by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
